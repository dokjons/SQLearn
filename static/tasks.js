const toggelTasks=document.getElementById("tasks-menu-toggle");toggelTasks.addEventListener("click",(()=>{document.getElementById("task-menu").classList.toggle("task-menu-toggle")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("task-list"),t=document.getElementById("current-task"),n=document.getElementById("task-desc"),s=document.getElementById("submit-task"),o=document.getElementById("show-hint"),d=document.getElementById("task-hint"),a=document.getElementById("task-completion-indicator");let l=null;fetch("/tasks?user_id=1").then((e=>e.json())).then((s=>{s.tasks.forEach((s=>{const o=document.createElement("li");o.textContent=s[1],o.dataset.taskId=s[0];const a=document.createElement("span");a.textContent=s[4]?"✔️":"❌",a.style.margin="0 10px",o.appendChild(a),o.addEventListener("click",(()=>{l={id:s[0],description:s[1],expected_query:s[2],hint:s[3]},n.textContent=l.description,t.style.display="block",d.style.display="none"})),e.appendChild(o)})),a.textContent=`Completed ${s.completed_count} out of ${s.total_count} tasks`})),s.addEventListener("click",(()=>{if(l){ace.edit("editor").getValue().trim().toLowerCase()===l.expected_query.toLowerCase()?(alert("Task completed successfully!"),fetch("/complete_task",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({user_id:1,task_id:l.id})}).then((e=>e.json())).then((e=>{if("success"===e.status){document.querySelectorAll("#task-list li").forEach((e=>{l&&e.dataset.taskId==l.id&&(e.querySelector("span").textContent="✔️")})),fetch("/tasks?user_id=1").then((e=>e.json())).then((e=>{a.textContent=`Completed ${e.completed_count} out of ${e.total_count} tasks`}))}})),l=null,t.style.display="none"):alert("Incorrect query. Please try again.")}else alert("Please select a task to complete.")})),o.addEventListener("click",(()=>{l&&(d.textContent=l.hint,d.style.display="block")}))}));
